C51 COMPILER V9.60.0.0   MAIN                                                              04/17/2023 17:30:03 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\System;..\Modules;..\User) DEB
                    -UG OBJECTEXTEND PRINT(..\Listings\main.lst) OBJECT(..\Objects\main.obj)

line level    source

   1          #include "delay.h"
   2          #include "uart.h"
   3          #include "str.h"
   4          #include "pwm.h"
   5          #include "key.h"
   6          #include "power.h"
   7          #include "timer.h"
   8          
   9          /**********************实验证明***************************
  10          
  11          将端口设置为准输入输出口时，通过N型MOS管AO3400
  12          驱动负载，端口处可以不接下拉电阻，如果非要下拉，须要500K以上的电阻。
  13          
  14          将端口设置为推挽输出口时，通过N型MOS管AO3400
  15          驱动负载，端口处也可以不接下拉电阻，如果非要下拉，应该在10K以上的电阻。
  16          ***********************************************************/
  17          
  18          /**********************实验证明***************************
  19          C语言中需要使用的字符串需要声明长度，不需要改变的可以直接定义指针。
  20          
  21          /************************主函数********************************/
  22          
  23          u8 Debug;
  24          
  25          void main (void)
  26          {
  27   1          s8 text[20] = {0};
  28   1          UART1_Init(115200);
  29   1          Timer0_Init(1000);
  30   1          PWM_Init();
  31   1          Key_Init();
  32   1          ADC_Init();
  33   1          Debug = 1;
  34   1          while (1)
  35   1          {
  36   2              SendData();
  37   2              PWM_SetDuty(0, 0xff - PWM0_Value);
  38   2              PWM_SetDuty(1, 0xff - PWM1_Value);
  39   2              if (Debug) {
  40   3                  IntToStr(text, PWM0_Value);
  41   3                  AddStr(text, "\t");
  42   3                  IntToStr(text+GetStrLen(text), PWM1_Value);
  43   3                  AddStr(text, "\t");
  44   3                  IntToStr(text+GetStrLen(text), TimeStamp);
  45   3                  AddStr(text, "\t");
  46   3                  FloatToStr(text+GetStrLen(text), ADC_GetValue()*4.142/513, 2);
  47   3                  AddStr(text, "V");
  48   3                  URAT1_PrintText(text);
  49   3              }
  50   2              WDT_CONTR |= 0x10;
  51   2              delay_ms(200);
  52   2          }
  53   1      }
  54          
C51 COMPILER V9.60.0.0   MAIN                                                              04/17/2023 17:30:03 PAGE 2   

  55          
  56          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    308    ----
   CONSTANT SIZE    =     24    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1      20
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
