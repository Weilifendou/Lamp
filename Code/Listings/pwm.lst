C51 COMPILER V9.60.0.0   PWM                                                               04/17/2023 16:55:01 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE PWM
OBJECT MODULE PLACED IN ..\Objects\pwm.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\Modules\pwm.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\System;..\Modules;..
                    -\User) DEBUG OBJECTEXTEND PRINT(..\Listings\pwm.lst) OBJECT(..\Objects\pwm.obj)

line level    source

   1          #include "pwm.h"
   2          
   3          u8 PWM0_Value;
   4          u8 PWM1_Value;
   5          
   6          void PWM_Init(void)
   7          {
   8   1          P3M0 &= ~(0x03 << 2);
   9   1          P3M1 &= ~(0x03 << 2); //PxM0与PxM1共同配置IO状态
  10   1          CMOD &= ~(0x03 << 1);
  11   1          CMOD |= (0x01 << 3); //设置为系统时钟倍率，相当于调节PWM频率
  12   1          CCAPM0 |= (0x01 << 1); //设置PCA模块0输出PWM
  13   1          CCAPM0 |= (0x01 << 6); //设置PCA模块0输出PWM
  14   1          CCAPM1 |= (0x01 << 1); //设置PCA模块1输出PWM
  15   1          CCAPM1 |= (0x01 << 6); //设置PCA模块1输出PWM
  16   1          PCA_PWM0 &= ~(0x01 << 1); //设置PWM0为8位PWM并使能0x20禁用，0x00使能
  17   1          PCA_PWM1 &= ~(0x01 << 1);
  18   1          CR = 1;  //启动PCA计数器
  19   1      }
  20          
  21          void PWM_SetDuty(u8 order, u8 duty)
  22          {
  23   1          if (order == 0)
  24   1          {
  25   2              if (duty == 0xff) {
  26   3                  PCA_PWM0 |= (0x01 << 1);
  27   3                  CCAP0H = duty;
  28   3              } else {
  29   3                  PCA_PWM0 &= ~(0x01 << 1);
  30   3                  CCAP0H = duty;
  31   3              }
  32   2          }
  33   1          else if (order == 1)
  34   1          {
  35   2              if (duty == 0xff) {
  36   3                  PCA_PWM1 |= (0x01 << 1);
  37   3                  CCAP1H = duty;
  38   3              } else {
  39   3                  PCA_PWM1 &= ~(0x01 << 1);
  40   3                  CCAP1H = duty;
  41   3              }
  42   2          }
  43   1          else if (order == 2)
  44   1          {
  45   2              if (duty == 0xff) {
  46   3                  PCA_PWM2 |= (0x01 << 1);
  47   3                  CCAP2H = duty;
  48   3              } else {
  49   3                  PCA_PWM2 &= ~(0x01 << 1);
  50   3                  CCAP2H = duty;
  51   3              }
  52   2          }
  53   1      }

C51 COMPILER V9.60.0.0   PWM                                                               04/17/2023 16:55:01 PAGE 2   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     98    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
